![image-20241021205436653](9.2.4.%E5%9B%BE%E5%BA%8A%E6%9C%8D%E5%8A%A1%E7%A8%8B%E5%BA%8F%E4%BB%A3%E7%A0%81%E9%80%BB%E8%BE%91%E5%88%86%E6%9E%90.assets/image-20241021205436653.png)

![image-20241021205456858](9.2.4.%E5%9B%BE%E5%BA%8A%E6%9C%8D%E5%8A%A1%E7%A8%8B%E5%BA%8F%E4%BB%A3%E7%A0%81%E9%80%BB%E8%BE%91%E5%88%86%E6%9E%90.assets/image-20241021205456858.png)



前端点击一个按钮，后台怎么知道调用哪个api？

httpparser（开源，手写非常花时间）

![image-20241021210134376](9.2.4.%E5%9B%BE%E5%BA%8A%E6%9C%8D%E5%8A%A1%E7%A8%8B%E5%BA%8F%E4%BB%A3%E7%A0%81%E9%80%BB%E8%BE%91%E5%88%86%E6%9E%90.assets/image-20241021210134376.png)

![image-20241021210330206](9.2.4.%E5%9B%BE%E5%BA%8A%E6%9C%8D%E5%8A%A1%E7%A8%8B%E5%BA%8F%E4%BB%A3%E7%A0%81%E9%80%BB%E8%BE%91%E5%88%86%E6%9E%90.assets/image-20241021210330206.png)

拓展：这种比较方式不是最高效的，可以尝试用map，hash等方式优化



文件上传逻辑

json.cpp很简单， rapidjson很快



解析

![image-20241021212253094](9.2.4.%E5%9B%BE%E5%BA%8A%E6%9C%8D%E5%8A%A1%E7%A8%8B%E5%BA%8F%E4%BB%A3%E7%A0%81%E9%80%BB%E8%BE%91%E5%88%86%E6%9E%90.assets/image-20241021212253094.png)

 

![image-20241021212509597](9.2.4.%E5%9B%BE%E5%BA%8A%E6%9C%8D%E5%8A%A1%E7%A8%8B%E5%BA%8F%E4%BB%A3%E7%A0%81%E9%80%BB%E8%BE%91%E5%88%86%E6%9E%90.assets/image-20241021212509597.png)

pipe：

![image-20241021215138002](9.2.4.%E5%9B%BE%E5%BA%8A%E6%9C%8D%E5%8A%A1%E7%A8%8B%E5%BA%8F%E4%BB%A3%E7%A0%81%E9%80%BB%E8%BE%91%E5%88%86%E6%9E%90.assets/image-20241021215138002.png)

execlp：执行函数，去执行一个shell命令，正常执行的话执行完就退出了

最后的fileid其实是重定向到pipe中的（dup2）

![image-20241021215511150](9.2.4.%E5%9B%BE%E5%BA%8A%E6%9C%8D%E5%8A%A1%E7%A8%8B%E5%BA%8F%E4%BB%A3%E7%A0%81%E9%80%BB%E8%BE%91%E5%88%86%E6%9E%90.assets/image-20241021215511150.png)





文件下载逻辑

![image-20241021220244270](9.2.4.%E5%9B%BE%E5%BA%8A%E6%9C%8D%E5%8A%A1%E7%A8%8B%E5%BA%8F%E4%BB%A3%E7%A0%81%E9%80%BB%E8%BE%91%E5%88%86%E6%9E%90.assets/image-20241021220244270.png)

![image-20241021220315916](9.2.4.%E5%9B%BE%E5%BA%8A%E6%9C%8D%E5%8A%A1%E7%A8%8B%E5%BA%8F%E4%BB%A3%E7%A0%81%E9%80%BB%E8%BE%91%E5%88%86%E6%9E%90.assets/image-20241021220315916.png)

6.共享文件处理

![image-20241021224455451](9.2.4.%E5%9B%BE%E5%BA%8A%E6%9C%8D%E5%8A%A1%E7%A8%8B%E5%BA%8F%E4%BB%A3%E7%A0%81%E9%80%BB%E8%BE%91%E5%88%86%E6%9E%90.assets/image-20241021224455451.png)

总结

![image-20241021224857821](9.2.4.%E5%9B%BE%E5%BA%8A%E6%9C%8D%E5%8A%A1%E7%A8%8B%E5%BA%8F%E4%BB%A3%E7%A0%81%E9%80%BB%E8%BE%91%E5%88%86%E6%9E%90.assets/image-20241021224857821.png)